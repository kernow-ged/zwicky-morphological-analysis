<!DOCTYPE html>
<html lang="en">

<head>
<title>Zwicky's Morphological Analysis online</title>
<meta charset="utf-8" />
<link rel="stylesheet" href="index.css"  type='text/css' />
<script type="text/javascript" src="jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="FileSaver.js"></script>
<script type="text/javascript">
'use strict';

var catnames = [];
var catvalues = [];

var results = [];
var rejectamenta = [];
var saved = [];

var resindex = 0;
var rejindex = 0;

function listCombinations() {
	var table = $('#combinations2');
	table.find("tr").remove();
	var dropdownA = $('#CatA');
	var dropdownB = $('#CatB');
	var indexA = dropdownA.prop("selectedIndex");
	var indexB = dropdownB.prop("selectedIndex");
	if (indexA == indexB)
		return;
	var valsA = catvalues[indexA];
	var valsB = catvalues[indexB];
	var html = "";
	console.log("combining from options:" + valsA + " and " + valsB);
	for(var i = 0; i < valsA.length; i++) {
		for(var j = 0; j < valsB.length; j++) {
			html += "<tr><td>" + valsA[i] + "</td>"
			html += "<td>" + valsB[j] + "</td>"
			html += "<td><button type='button' onClick=\"disallowCombination(this," + indexA + ",'" + valsA[i] + "',"  + indexB + ",'" + valsB[j] + "');\">Disallow</button></td></tr>"
		}
	}
	table.append(html)
}; 

function disallowCombination(button, i, valA, j, valB) {
	console.log("removing:" + i + "/" + valA + " , " + j + "/" + valB);
	var reason = window.prompt("The combination:" + catnames[i] + "=" + valA + " and " + catnames[j] + "=" + valB + " is not allowed because ");
	if (reason) {
		var excludes = $('#excludes');
		var line = "";
		for(var k = 0; k < catnames.length; k++) {
			if (k == i) {
				line += " " + valA;
			}
			else if (k == j) {
				line += " " + valB;
			}
			else {
				line += " *";
			}
		}
		console.log("trimming: " + line);
		line = $.trim(line);
		console.log("appending: " + line);
		excludes.val(excludes.val() + line + " | " + reason + "\n");
		console.log("setting button disallowed: " + button);
		$(button).addClass("disallowed");
	}
};

function appendSolution(resulttable, values) {
    var result = [];
    result.push(results.length + 1);
	for(var i = 0; i < catnames.length; i++) {
        result.push(values[i]);
	}
    result.push(""); 
    results.push(result);
}

function appendCutNote(resulttable, values, rule, reason) {
    var reject = [];
    reject.push(rejectamenta.length + 1); 
	for(var i = 0; i < catnames.length; i++) {
        reject.push(values[i]);
	}
    reject.push(reason);
    rejectamenta.push(reject);
}


function countCombinations(allowedvalues) {
	// cartesian product for cardinality
	var ncomb = 1;
	for(var i = 0; i < allowedvalues.length; i++) {
		ncomb *= allowedvalues[i].length;
	}
	return ncomb;
}

function has_options(allowedvalues, excludes, resultstable = undefined) {
	// go through excludes
	// if excludes matches allowedvalues with the relevant fields only having one option
	// return empty allowedvalues
	for(var i = 0; i < excludes.length; i++) {
		var rule_line = excludes[i];
		if ($.trim(rule_line) == "")
			continue;
		if (rule_line.startsWith("#"))
			continue;
		var parts = rule_line.split("|", 2);
		var rule = $.trim(parts[0]).split(" ");
		if (rule.length != allowedvalues.length) {
			console.log("invalid rule: '" + rule_line + "', because " +  rule.length + "!=" + allowedvalues.length);
			continue;
		}
		//console.log("checking rule: '" + rule_line + "'");
		var reason = $.trim(parts[1]);
		var rule_applies = true;
		for(var j = 0; j < allowedvalues.length; j++) {
			if (rule[j] == "*")
				continue;
			if (allowedvalues[j].length > 1) {
				rule_applies = false;
				//console.log("rule does not apply yet, have other options");
				break;
			}
			if (allowedvalues[j][0] == rule[j]) {
				rule_applies = true;
			} else {
				rule_applies = false;
				//console.log("rule does not match");
				break;
			}
		}
		if (rule_applies) {
			if(resultstable) {
				appendCutNote(resultstable, allowedvalues, rule, reason);
			}
			return false;
		}
	}
	return true;
}

function indexOfMin(arr) {
	if (arr.length === 0) {
		return -1;
	}

	var minValue = arr[0];
	var minIndex = 0;

	for (var i = 1; i < arr.length; i++) {
		if (isNaN(minValue) || arr[i] < minValue) {
			minIndex = i;
			minValue = arr[i];
		}
	}

    return minIndex;
}
function sum(arr){
	var total = 0;
	for(var i = 0; i < arr.length; i++) 
		total += arr[i];
	return total;
}

function recursiveGenerateSolutions(resulttable, allowedvalues, excludes, depth) {
	var prefix = "  ".repeat(depth);
	console.log(prefix + "  generating solutions@" + depth + ": " + allowedvalues.join(";"));
	if(depth>100){
		console.log("stopping recursion at level 100");
		return;
	}
	var single_solution = true;
	for(var i = 0; i < allowedvalues.length; i++) {
		if (allowedvalues[i].length != 1) {
			single_solution = false;
			break;
		}
	}
	if(single_solution) {
		console.log(prefix + "  emitting solution");
		appendSolution(resulttable, allowedvalues);
		return;
	}
	// go through each category
	// find the one with the strongest reduction in options
	var noptions_list = [];
	var noptions = [];
	for(var i = 0; i < catnames.length; i++) {
		var newallowedvalues = allowedvalues.slice();
		var noptions_here = [];
		for(var j = 0; j < allowedvalues[i].length; j++) {
			newallowedvalues[i] = [allowedvalues[i][j]];
			if (has_options(newallowedvalues, excludes))
				noptions_here.push(countCombinations(newallowedvalues));
			else
				noptions_here.push(0);
		}
		noptions_list.push(noptions_here);
		if (allowedvalues[i].length == 1 || noptions_here == 0) {
			// already have only one option, cannot select here;
			noptions.push(NaN);
		} else {
			noptions.push(sum(noptions_here));
		}
	}
	console.log(prefix + "  number of options: " + noptions + ", or, in detail:" + noptions_list.join("|"));
	// select the one with lowest number of remaining options
	var cat_selected = indexOfMin(noptions);

	// order the choices within that category by the number of possibilities
	
	//for(var i = 0; i < catnames.length; i++) {
	console.log(prefix + "  selecting on " + cat_selected + ": "  + catnames[cat_selected]);
	var options = allowedvalues[cat_selected];
	var options_indices = [];
	for(var j = 0; j < options.length; j++) {
		//console.log(prefix + "    noptions of " + options[j] + ": " + noptions_list[cat_selected][j]);
		options_indices.push(j);
	}
	options_indices.sort(
		function(a,b) {
			var va = noptions_list[cat_selected][a];
			var vb = noptions_list[cat_selected][b];
			var r = va - vb;
			//console.log(prefix + "    comparing " + va + " and " + vb + "->" + r);
			return r;
		}
	);
	for(var j = 0; j < options_indices.length; j++) {
		var k = options_indices[j];
		//console.log(prefix + "    ordered:" + k + " noptions of " + options[k] + ": " + noptions_list[cat_selected][k]);
	}
	var newallowedvalues = allowedvalues.slice();
	for(var j = 0; j < options_indices.length; j++) {
		var k = options_indices[j];
		newallowedvalues[cat_selected] = [options[k]];
		console.log(prefix + "  assuming: " + catnames[cat_selected] + "=" + options[k]);
		if (has_options(newallowedvalues, excludes, resulttable)) {
			recursiveGenerateSolutions(resulttable, newallowedvalues, excludes, depth+1);
		}
	}
}


function changeDisplayItem(index, identifier){ 
   var values=[];
   if(identifier=='result') values=results[index];
   else values=rejectamenta[index];
   var html="";
   for(var i=0; i<values.length; i++) {
      html += "<td>" + values[i] + "</td>";
      }
   document.getElementById(identifier).innerHTML=html;
}

function generateSolutions() {
	var resulttable = $('#resulttable');
	var ncol = catnames.length;
	var excludes = $("#excludes").val().split("\n");
	// clear result table
	resulttable.find("tr").remove();
	// fill result table
	var html = "<tr>";
    html += "<th class='invariantfield'> Entry </th>";
	for(var i = 0; i < catnames.length; i++) {
		html += "<th class='category-entry'>" + catnames[i] + "</th>";
	}
    html += "<th class='invariantfield'> Notes </th>";
	html += "</tr>"
    html += "<tr id='result'></tr>" ;
	resulttable.append(html);
 
	var rejecttable = $('#rejecttable');
	var ncol = catnames.length;
	var excludes = $("#excludes").val().split("\n");
	// clear result table
	rejecttable.find("tr").remove();
	// fill result table
	var html = "<tr>";
    html += "<th class='invariantfield-rejects'> Entry </th>";
	for(var i = 0; i < catnames.length; i++) {
		html += "<th class='invariantfield-rejects'>" + catnames[i] + "</th>";
	}
    html += "<th class='invariantfield-rejects'> Notes </th>";
	html += "</tr>"
    html += "<tr id='reject'></tr>" ;
	rejecttable.append(html);
    results = [];
    rejectamenta = [];
    saved = [];
    $("#saved").css("display", "none");
	console.log("generating solutions...");
	recursiveGenerateSolutions(resulttable, catvalues, excludes, 0);
    document.getElementById('results-indicator').innerHTML="Results (" + results.length + " items)";
    document.getElementById('rejects-indicator').innerHTML="Rejectamenta (" + rejectamenta.length + " items)";
    changeDisplayItem(0, 'result');
    changeDisplayItem(0, 'reject');  
    resindex = 0;
    rejindex = 0;
    $("#respanel").css("display", "block");
    $("#rejpanel").css("display", "block");   
}

function clear_inputs(fields) {
	for(var i = 0; i < fields.length; i++) {
		console.log("clearing " + fields[i]);
		fields[i].value = "";
	}
}

function decode_categories(categories) {
	var table = $('#blacklistgrid');
	var fields = table.find('input');
	clear_inputs(fields);
	for(var i = 0; i < categories.length; i++) {
		var keyvals = categories[i].split(":");
		if (keyvals.length != 2)
			continue;
		var key = keyvals[0];
		var vals = keyvals[1];
		if (fields.length < i*2+2) {
			var first_row = $('#Row2');
			var newrow = first_row.clone();
			newrow.find("input").val("");
			newrow.appendTo('#blacklistgrid');
			Array.prototype.push.apply(fields, newrow.find("input"));
		}
		fields[i*2].value = key;
		fields[i*2+1].value = vals;
	}
}

function load_from_url() {
	var hash = window.location.hash.substr(1);
	console.log("loading data from url: " + hash);
	var parts = hash.split("&");
	for(var i = 0; i < parts.length; i++) {
		var keyvals = parts[i].split("=");
		if (keyvals.length != 2)
			continue;
		var key = keyvals[0];
		var val = decodeURIComponent(keyvals[1]);
		if (key == "cats") {
			decode_categories(val.split(";"));
		} else if (key == "excl") {
			var excludes = $('#excludes');
			excludes.val(val);
		} else {
			console.log("unexpected argument:" + key);
		}
	}
}
function generateUrl() {
	var excludes = $('#excludes');
	var excludes_text = encodeURIComponent(excludes.val());
	console.log("excludes encoded to:" + excludes_text);
	var table = $('#blacklistgrid');
	var fields = table.find('input');
	var categories = []
	for(var i = 0; i < fields.length; i+=2) {
		var key = fields[i].value;
		var vals = fields[i+1].value;
		var keyvals = key + ":" + vals;
		categories.push(keyvals);
	}
	var categories_text = encodeURIComponent(categories.join(";"));
	console.log("categories:" + categories + " encoded to:" + categories_text);
	var url = "#cats=" + categories_text + "&excl=" + excludes_text;
	return url;
}

function searchResultsWithCriteria(value) {
  var criteria = document.getElementById('res-randomcriteria').value.split(" ");
  for(var i=0; i<criteria.length; i++) {
      if(criteria[i] == "" || criteria[i] == "*") {}
	else {
           if(!value.flat().includes(criteria[i]))
           return 0;
      }
  }
  return 1;
}

function searchRejectsWithCriteria(value) {
  var criteria = document.getElementById('rej-randomcriteria').value.split(" ");
  for(var i=0; i<criteria.length; i++) {
      if(criteria[i] == "" || criteria[i] == "*") {}
	else {
           if(!value.flat().includes(criteria[i]))
           return 0;
      }
  }
  return 1;
}

function goto_rej(input) {  
	var index = 0;
	if(isNaN(input)) {
	  index = 0;
	  rejindex = 0;
	}
	else {
	  index = Number(input)-1;
	  if (index <0 || index > rejectamenta.length) {
	    rejindex = 0;
	  }
	  else {
	  rejindex = index;
	  }
	}
	changeDisplayItem(rejindex, "reject");
}


function goto_res(input) {  
	var index = 0;
	if(isNaN(input)) {
	  index = 0;
	  resindex = 0;
	}
	else {
	  index = Number(input)-1;
	  if (index <0 || index > results.length) {
	    resindex = 0;
	  }
	  else {
	  resindex = index;
	  }
	}
	changeDisplayItem(resindex, "result");
}


function rebuildSavetable() {
    $("#saved").css("display", "block");   
    var html = "<table><tr>";
    html += "<th class='invariantfield'> Entry </th>";
    for(var i = 0; i < catnames.length; i++) {
	   html += "<th class='category-entry'>" + catnames[i] + "</th>";
	  }
    html += "<th class='invariantfield'> Notes </th>";
    html += "<th class='invariantfield'> <span id='remove'>Modify</span> </th>";
    html += "</tr>"
   for(var j=0; j<saved.length; j++) {
       html +="<tr>";
       for (var i=0; i<saved[j].length; i++)  {
          html +="<td>"  + saved[j][i]  + "</td>";  
        }
        html +="<td> <span class='removable' id='remove-" +  j  +   "'>remove</span> | <span class='editable' id='edit-" +  j  +  "'>add/edit note</span></td>";  
        html +="</tr>"
    }
    html +="</table>";
   document.getElementById('savetable').innerHTML=html;
   $(document).ready(function () {   
           $(".removable").click(function () {
          removeSaved(Number(this.id.substring(7)));
		});	  

        $(".editable").click(function () {
          editSaved(Number(this.id.substring(5)));
		});	
        
   });
}


function editSaved(index) {
  var note = prompt("Add note for entry " + saved[index][0], saved[index][saved[index].length-1]);
  if (note == null) {} 
  else {
    saved[index][saved[index].length-1] = note;
  } 
  rebuildSavetable();  
  changeDisplayItem(resindex, "result"); // update shallow-copied results entry, if it is the same  
}

function removeSaved(index) {
    saved.splice(index,1);
    if(saved.length == 0) {
       $("#saved").css("display", "none"); 
    }
    else {
       rebuildSavetable();
    }
}

function exportCSV(arr, name) {
   var csv = "Entry,";
   for(var i=0; i<catnames.length; i++) {
      csv += catnames[i] + ",";
   }
   csv += "Notes"
   csv +="\n";
   for(var j=0; j<arr.length; j++) {
      csv += arr[j][0].toString() + ",";
      for(var i=1; i<arr[j].length; i++) {
      var f = arr[j][i].toString();
      var str = "";
      if(f.includes(",")) {
	     str = f;
         if(f.includes("\"")) {
	        str = str.replaceAll("\"", "\"\"");
	     }
	     str = "\"" + str + "\"";
         }
        else {
          str = f;
        }
        if(i == arr[j].length-1) csv += str;
        else csv += str + ",";
       }
     if(j == arr.length-1) {}
     else csv +="\n";
    } 
    var blob = new Blob([csv], {type: "text/csv;charset=utf-8"});
    saveAs(blob, name + ".csv");
}

$(window).on('load', function () {

	$(document).ready(function () {
		$('#clear').click(function () {
			var table = $('#blacklistgrid');
			var fields = table.find('input');
			clear_inputs(fields);
			var excludes = $('#excludes');
			excludes.val("");
			window.location.hash = "";
			$('#btnXLoad').click();
		});
		$('#example1').click(function () {
			var table = $('#blacklistgrid');
			var fields = table.find('input');
			clear_inputs(fields);
			fields[0].value = "Color"
			fields[1].value = "red yellow green"
			fields[2].value = "Shape"
			fields[3].value = "circle square"
			var excludes = $('#excludes');
			excludes.val("red circle | error should look threatening\ngreen square | info should look friendly");
			$('#btnXLoad').click();
		});

		$('#example2').click(function () {
			var table = $('#blacklistgrid');
			var fields = table.find('input');
			clear_inputs(fields);
			fields[0].value = "Color"
			fields[1].value = "red yellow green"
			fields[2].value = "Shape"
			fields[3].value = "circle square"
			fields[4].value = "Texture"
			fields[5].value = "hard soft"
			var exclusions = "green square * | squares are warning shapes\n"
			exclusions += "* circle hard | ugly\n";
			exclusions += "* square soft | squares should be hard warnings\n"; // there was a typo here where it said 'squares' instead of 'square'
			var excludes = $('#excludes');
			excludes.val(exclusions);
			$('#btnXLoad').click();
		});

		$('#btnAdd').click(function () {
			var count = 3;
			var first_row = $('#Row2');
			while (count-- > 0) {
				var newrow = first_row.clone();
				newrow.find("input").val("");
				newrow.appendTo('#blacklistgrid');
			}
		});

		 
		$('#btnXLoad').click(function () {
			var table = $('#blacklistgrid');
			var dropdownA = $('#CatA');
			var dropdownB = $('#CatB');
			var iinput = 0;
			dropdownA.find("option").remove();
			dropdownB.find("option").remove();
			
			console.log("loading combinations ...");
			catnames = [];
			catvalues = [];
			
			table.find('input').each(function () {
				console.log("  value " + iinput + " " + this.value);
				if(iinput % 2 == 0) {
					var val = this.value;
					if (val == "")
						return;
					catnames.push(val);
					var i = iinput/2;
					var newopt = $("<option />").val(i).text(val);
					dropdownA.append(newopt);
					var newopt = $("<option />").val(i).text(val);
					dropdownB.append(newopt);
				} else {
					var val = this.value;
					catvalues.push(val.split(' '));
				}
				iinput++;
			});
			dropdownA.prop("selectedIndex", 0);
			dropdownB.prop("selectedIndex", 1);
			listCombinations();
		});


		$('#btnXPrev').click(function () {
			var dropdownA = $('#CatA');
			var dropdownB = $('#CatB');
			var indexA = dropdownA.prop("selectedIndex");
			var indexB = dropdownB.prop("selectedIndex");
			console.log("A:" + indexA + " B:" + indexB);
			if (indexA > 0) {
				dropdownA.prop("selectedIndex", indexA - 1);
				console.log("prev A");
			}
			if (indexB > 1) {
				dropdownB.prop("selectedIndex", indexB - 1);
				console.log("prev B");
			}
			listCombinations();
		});

		$('#btnXNext').click(function () {
			var dropdownA = $('#CatA');
			var dropdownB = $('#CatB');
			var indexA = dropdownA.prop("selectedIndex");
			var indexB = dropdownB.prop("selectedIndex");
			console.log("A:" + indexA + " B:" + indexB);
			if (indexA < dropdownA.children("option").length - 2) {
				dropdownA.prop("selectedIndex", indexA + 1);
				console.log("next A, " + dropdownA.length);
			}
			if (indexB < dropdownB.children("option").length - 1) {
				dropdownB.prop("selectedIndex", indexB + 1);
				console.log("next B, " + dropdownB.length);
			}
			listCombinations();
		});

		$('#CatA').change(listCombinations);
		$('#CatB').change(listCombinations);
		
		$('#btnFinish').click(generateSolutions);
		
		$('#btnShareUrl').click(function () {
			var url = generateUrl();
			window.location.hash = url;
			var fullurl = window.location.href;
			var urltextfield = $('#shareurl')
			urltextfield.val(fullurl);
			urltextfield.select();
		});
		
		$('#resprev').click(function () {
            resindex = resindex-1;
            if(resindex < 0) resindex = results.length-1;
            changeDisplayItem(resindex, 'result');
		});		
        
 		$('#resnext').click(function () {
            resindex = resindex+1;
            if(resindex >= results.length) resindex = 0;
            changeDisplayItem(resindex, 'result');
		});  

 		$('#rejprev').click(function () {
            rejindex = rejindex-1;
            if(rejindex < 0) rejindex = rejectamenta.length-1;
            changeDisplayItem(rejindex, 'reject');            
		});		
        
 		$('#rejnext').click(function () {
            rejindex = rejindex+1;
            if(rejindex >= rejectamenta.length) rejindex = 0;
            changeDisplayItem(rejindex, 'reject');           
		});        
        
 		$('#resrand').click(function () {
          if(document.getElementById('res-randomcriteria').value !="") {
              var subarray = results.filter(searchResultsWithCriteria);
              if(subarray.length > 0) {
                  var item = subarray[Math.floor(Math.random()*subarray.length)];
                  resindex = item[0]-1;
                  changeDisplayItem(resindex, 'result');
                  return;
              }
           }      
           resindex = Math.floor(Math.random()*results.length);
           changeDisplayItem(resindex, 'result');           
		});  

 		$('#rejrand').click(function () {
          if(document.getElementById('rej-randomcriteria').value !="") {
              var subarray = rejectamenta.filter(searchRejectsWithCriteria);
              if(subarray.length > 0) {
                  var item = subarray[Math.floor(Math.random()*subarray.length)];
                  rejindex = item[0]-1;
                  changeDisplayItem(rejindex, 'reject');
                  return;
              }
           }
           rejindex = Math.floor(Math.random()*rejectamenta.length);  
           changeDisplayItem(rejindex, 'reject');              
		});		
 
 		$('#resfirst').click(function () {
           resindex = 0;
           changeDisplayItem(resindex, 'result');           
		});  

 		$('#rejfirst').click(function () {
           rejindex = 0;  
           changeDisplayItem(rejindex, 'reject');              
		});	 
 
 		$('#resgoto').click(function () {
           goto_res($("#res-goto-entry").val()); 
		});  

 		$('#rejgoto').click(function () {
           goto_rej($("#rej-goto-entry").val());              
		});	

        $(document).keyup(function(event) {
            if ($("#res-goto-entry").is(":focus") && event.key == "Enter") {
                goto_res($("#res-goto-entry").val());
            }
            if ($("#rej-goto-entry").is(":focus") && event.key == "Enter") {
                goto_rej($("#rej-goto-entry").val());
            }            
        });
 
 		$('#ressave').click(function () {
            saved.push(results[resindex]);
            rebuildSavetable();
		});	  
 
        $('#btnGenCSVSaved').click(function () {
            exportCSV(saved, 'saved');
		});	  
        
         $('#btnGenCSVResults').click(function () {
            exportCSV(results, 'results');
		});	

        $('#btnGenCSVRejectamenta').click(function () {
            exportCSV(rejectamenta, 'rejectamenta');
		});	
      
		load_from_url();
		$('#btnXLoad').click();
	});

 });
</script>

</head>
<h1>Zwicky's Morphological Analysis online</h1>

<a href="https://github.com/JohannesBuchner/zwicky-morphological-analysis/"><img style="position: absolute; top: 0; right: 0; border: 0;" src="forkme_light_background.png" alt="Fork me on GitHub"></a>

<form name="myform" id="myform">
<p><small>(Based on <a href="https://johannesbuchner.github.io/zwicky-morphological-analysis/">https://johannesbuchner.github.io/zwicky-morphological-analysis/</a>)</small></p>
<div class="step">
<h3>Step 1: Define Problem Space</h3>

<p>Explanation: In morphological analysis, the problem dimensions are first specified. 
These can be somewhat overlapping.
Any impossible combinations are excluded in the next step.
</p>

<p>Insert category name and allowed values (space separated).</p>
<p><a id="clear" class="fillexample">Clear</a> | 
<a id="example1" class="fillexample">Load example 1</a> | 
<a id="example2" class="fillexample">Load example 2</a> |
<a id="example3" target="_blank" href="index.html#cats=Plan%3Afull_plan%20specific_plan%20routine_specific%20routine_general%20alertplan%3BTraining%3Aco-op%20specific%20base%2Bregular%20base%3BPersonnel%3A11%2B%208-10%205-7%20%3C4%3BEquipment%3Aspecial%20base%20subbase%3BLeadershipLevel%3A4%203%202%201%3BResponseChem%3A80%2510m%2080%2530m%2050%2515m%2050%2530m%20None30m%3BResponseInfo%3A%3C5min%20%3C30min%20%3E30min%3BResponsePeople%3Amany30min%20some15min%20some30min%20None30min&excl=full_plan%20specific%20*%20*%20*%20*%20*%20*%20%7C%20Plan%20not%20completely%20trained%20for%0Afull_plan%20base%2Bregular%20*%20*%20*%20*%20*%20*%20%7C%20Plan%20not%20completely%20trained%20for%0Afull_plan%20base%20*%20*%20*%20*%20*%20*%20%7C%20Plan%20not%20completely%20trained%20for%0Aspecific_plan%20base%2Bregular%20*%20*%20*%20*%20*%20*%20%7C%20Plan%20not%20completely%20trained%20for%0Aspecific_plan%20base%20*%20*%20*%20*%20*%20*%20%7C%20Plan%20not%20completely%20trained%20for%0Aroutine_specific%20base%20*%20*%20*%20*%20*%20*%20%7C%20Plan%20not%20completely%20trained%20for%0Aroutine_general%20co-op%20*%20*%20*%20*%20*%20*%20%7C%20Training%20without%20plan%0Aalertplan%20co-op%20*%20*%20*%20*%20*%20*%20%7C%20Training%20without%20plan%0Aalertplan%20specific%20*%20*%20*%20*%20*%20*%20%7C%20Training%20without%20plan%0Afull_plan%20*%20*%20subbase%20*%20*%20*%20*%20%7C%20Equipment%20worse%20than%20plan%0Aspecific_plan%20*%20*%20subbase%20*%20*%20*%20*%20%7C%20Equipment%20worse%20than%20plan%0Aroutine_specific%20*%20*%20subbase%20*%20*%20*%20*%20%7C%20Equipment%20worse%20than%20plan%0Aroutine_general%20*%20*%20special%20*%20*%20*%20*%20%7C%20Plan%20worse%20than%20equipment%0Aalertplan%20*%20*%20special%20*%20*%20*%20*%20%7C%20Plan%20worse%20than%20equipment%0Afull_plan%20*%20*%20*%203%20*%20*%20*%20%7C%20e%0Afull_plan%20*%20*%20*%202%20*%20*%20*%20%7C%20e%0Afull_plan%20*%20*%20*%201%20*%20*%20*%20%7C%20e%0Aspecific_plan%20*%20*%20*%202%20*%20*%20*%20%7C%20e%0Aspecific_plan%20*%20*%20*%201%20*%20*%20*%20%7C%20e%0Aroutine_specific%20*%20*%20*%201%20*%20*%20*%20%7C%20e%0Aroutine_general%20*%20*%20*%20*%2080%2510m%20*%20*%20%7C%20Generic%20response%20is%20slow%2Fineffective%0Aroutine_general%20*%20*%20*%20*%2080%2530m%20*%20*%20%7C%20Generic%20response%20is%20slow%2Fineffective%0Aroutine_general%20*%20*%20*%20*%2050%2515m%20*%20*%20%7C%20Generic%20response%20is%20slow%2Fineffective%0Aalertplan%20*%20*%20*%20*%2080%2510m%20*%20*%20%7C%20Alert-only%20is%20ineffective%0Aalertplan%20*%20*%20*%20*%2080%2530m%20*%20*%20%7C%20Alert-only%20is%20ineffective%0Aalertplan%20*%20*%20*%20*%2050%2515m%20*%20*%20%7C%20Alert-only%20is%20ineffective%0Aalertplan%20*%20*%20*%20*%2050%2530m%20*%20*%20%7C%20Alert-only%20is%20ineffective%0Aroutine_specific%20*%20*%20*%20*%20*%20%3C5min%20*%20%7C%20Generic%20response%20is%20slow%0Aroutine_general%20*%20*%20*%20*%20*%20%3C5min%20*%20%7C%20Generic%20response%20is%20slow%0Aalertplan%20*%20*%20*%20*%20*%20%3C5min%20*%20%7C%20Alert-only%20is%20ineffective%0A*%20base%2Bregular%20*%20special%20*%20*%20*%20*%20%7C%20cannot%20use%20special%20equipment%20with%20generic%20training%0A*%20base%20*%20special%20*%20*%20*%20*%20%7C%20cannot%20use%20special%20equipment%20with%20generic%20training%0A*%20base%2Bregular%20*%20*%20*%2080%2510m%20*%20*%20%7C%20generic%20training%20leads%20to%20slow%20response%0A*%20base%2Bregular%20*%20*%20*%2080%2530m%20*%20*%20%7C%20generic%20training%20leads%20to%20slow%20response%0A*%20base%2Bregular%20*%20*%20*%2050%2515m%20*%20*%20%7C%20generic%20training%20leads%20to%20slow%20response%0A*%20base%20*%20*%20*%2080%2510m%20*%20*%20%7C%20generic%20training%20leads%20to%20slow%20response%0A*%20base%20*%20*%20*%2080%2530m%20*%20*%20%7C%20generic%20training%20leads%20to%20slow%20response%0A*%20base%20*%20*%20*%2050%2515m%20*%20*%20%7C%20generic%20training%20leads%20to%20slow%20response%0A*%20*%2011%2B%20*%202%20*%20*%20*%20%7C%20h%0A*%20*%2011%2B%20*%201%20*%20*%20*%20%7C%20h%0A*%20*%208-10%20*%204%20*%20*%20*%20%7C%20number%20unavailable%0A*%20*%205-7%20*%204%20*%20*%20*%20%7C%20number%20unavailable%0A*%20*%205-7%20*%203%20*%20*%20*%20%7C%20number%20unavailable%0A*%20*%20%3C4%20*%204%20*%20*%20*%20%7C%20number%20unavailable%0A*%20*%20%3C4%20*%203%20*%20*%20*%20%7C%20number%20unavailable%0A*%20*%20%3C4%20*%202%20*%20*%20*%20%7C%20number%20unavailable%0A*%20*%20%3C4%20*%20*%2080%2510m%20*%20*%20%7C%20insufficient%20manpower%0A*%20*%20%3C4%20*%20*%2080%2530m%20*%20*%20%7C%20insufficient%20manpower%0A*%20*%20%3C4%20*%20*%2050%2515m%20*%20*%20%7C%20insufficient%20manpower%0A*%20*%20%3C4%20*%20*%2050%2530m%20*%20*%20%7C%20insufficient%20manpower%0A*%20*%20*%20base%20*%2080%2510m%20*%20*%20%7C%20generic%20equipment%20does%20not%20allow%20fast%20response%0A*%20*%20*%20base%20*%2080%2530m%20*%20*%20%7C%20generic%20equipment%20does%20not%20allow%20complete%20response%0A*%20*%20*%20subbase%20*%2080%2510m%20*%20*%20%7C%20poor%20equipment%20does%20not%20allow%20complete%20response%0A*%20*%20*%20subbase%20*%2080%2530m%20*%20*%20%7C%20poor%20equipment%20does%20not%20allow%20complete%20response%0A*%20*%20*%20subbase%20*%2050%2515m%20*%20*%20%7C%20poor%20equipment%20does%20not%20allow%20fast%20response%0A">Load example from video</a>
</p>
<p><small>(The video in question is <a href="https://www.youtube.com/watch?v=x4zAniSP0FY">this one</a>)</small></p>
<table id="blacklistgrid">
<tr id="Row1">
<th>Category name</th><th>Values (space separated)</th>
</tr>
<tr id="Row2">
<th><input value="Color"/></th><td><input value="green blue red" /></td>
</tr>
<tr id="Row3">
<th><input value="Shape"/></th><td><input value="circle square triangle"/></td>
</tr>
<tr id="Row4">
<th><input /></th><td><input /></td>
</tr>
<tr id="Row5">
<th><input /></th><td><input /></td>
</tr>
<tr id="Row6">
<th><input /></th><td><input /></td>
</tr>

</table>

<button type="button" id="btnAdd">Add a few more</button>


</div>

<div class="step">
<h3>Step 2: Exclude options</h3>

<p>Here, pairwise combinations can be considered and removed if they are impossible.
For each such case, also give as a comment the reason.</p>

<p><button type="button" id="btnXLoad" accesskey="L">Load specified categories</button> (needed whenever categories change)</p>

<button type="button" id="btnXPrev">&laquo;</button>
<select id="CatA" name="CatA"></select>
<select id="CatB" name="CatB"></select>
<button type="button" id="btnXNext">&raquo;</button>

<table id="combinations2">
</table>

</div>

<div class="step">
<h3>Step 3: Complex excludes</h3>

<p>Here all the exclusions are listed. </p>

<p>Syntax: space separated values for each category, * if any. The number of categories has to match the number of values.
Reason is given after |</p>

<textarea id="excludes" name="excludes" rows="12" cols="100" ></textarea>
</div>

<div class="step">
<h3>Explore Solution space:</h3>
<p>Generate all possible solutions of the problem. Here the problem is explored such 
that the argument (exclusion) that removes the most possibilities is invoked first.</p>

<p>This can be very helpful for making a systematic argument, while being sure that all possibilities 
have been considered.</p>

<button type="button" id="btnFinish" accesskey="X">Explore solutions!</button> <span id='nsolutions'></span><br/>
<button type="button" id="btnShareUrl">Generate URL to share</button><input id="shareurl"></input>

<div class="result">
<h3 id="results-indicator"></h3>
<table id="resulttable"></table>
<div id="respanel" style="display:none">
<div class="ctrls"><span id='resprev'>prev</span> | <span id='resnext'>next</span> | <span id='resrand'>random</span> | <span id='resfirst'>first</span> |   <span id='resgoto'>goto</span> <input id='res-goto-entry' class='goto' size="3"/> | <span id='ressave'>save</span></div><br/>
constraints on randomiser <input id='res-randomcriteria' /><br />
<small>(Syntax: same as for the 'complex excludes' field. For example, given example 2 above, <b>red * *</b> means that the colour must be red but that the other two fields can be random)</small><br />
<button type="button" id="btnGenCSVResults">Export CSV</button>
</div>

<div id="saved" style="display:none">
<h3>Saved entries</h3>
<div id="savetable"></div>
<button type="button" id="btnGenCSVSaved">Export CSV</button>
</div>


<h3 id="rejects-indicator"></h3>
<table id="rejecttable"></table>

<div id="rejpanel" style="display:none">
<div class="ctrls"><span id='rejprev'>prev</span> | <span id='rejnext'>next</span> | <span id='rejrand'>random</span> | <span id='rejfirst'>first</span> |  <span id='rejgoto'>goto</span> <input id='rej-goto-entry' class='goto' size="3"/></div><br/>
constraints on randomiser <input id='rej-randomcriteria'/><br />
<button type="button" id="btnGenCSVRejectamenta">Export CSV</button>
</div>

</div>

</div>

</form>



</html>
